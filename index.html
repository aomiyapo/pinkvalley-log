<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pink Valley Panic Log</title>
<style>
body {
  margin:0;
  padding:0;
  font-family: monospace;
  background:black;
  color:#ff69b4;
  overflow:hidden;
}
#log {
  height:100vh;
  overflow-y:auto;
  position:relative;
}
.line {
  display:block;
  margin-bottom:2px;
  white-space: pre;
  opacity:0;
  transition:opacity 0.1s;
}
.line.error {
  color:#ff1493;
  font-weight:bold;
}
.char {
  display:inline-block;
  transition: color 0.2s;
}
</style>
</head>
<body>
<div id="log"></div>
<script>
document.addEventListener('DOMContentLoaded', ()=>{
  const logDiv = document.getElementById('log');

  const totalLines = 1000; // для теста, потом можно 10000
  const flyingLines = [];
  let i=0;
  let failurePhase=false;
  const errorBlocks=[5,7,4,6];
  let currentBlock=0;
  let blockLinesLeft=0;
  let inBlock=false;
  let panicMode=false;

  function updatePanic(){
    flyingLines.forEach(obj=>{
      obj.el.style.left = Math.random()*(window.innerWidth-200)+'px';
      obj.el.style.top = Math.random()*(window.innerHeight-20)+'px';
      obj.el.style.transform = `rotate(${Math.random()*360-180}deg)`;
      // мигание букв
      const chars = obj.el.querySelectorAll('.char');
      chars.forEach(c=>{
        if(Math.random()<0.1){
          c.style.color = ['#ff69b4','#ff1493','#ffb6c1'][Math.floor(Math.random()*3)];
        }
      });
    });
    requestAnimationFrame(updatePanic);
  }

  function showLine(){
    if(i>=totalLines) return;

    const lineEl = document.createElement('div');
    lineEl.className='line';
    let text;

    // запускаем блок ошибок на 700-й строке
    if(i>=700 && !failurePhase){
      failurePhase = true;
      inBlock = true;
      blockLinesLeft = errorBlocks[0];
      currentBlock = 0;
    }

    // блок ошибок
    if(failurePhase && inBlock && currentBlock<errorBlocks.length){
      text = `|~CRITICAL_SYSTEM_FAILURE : CODE_${Math.floor(Math.random()*9999)}~|`;
      lineEl.classList.add('error');
      blockLinesLeft--;
      if(blockLinesLeft<=0){
        inBlock=false;
        currentBlock++;
        if(currentBlock>=errorBlocks.length){
          panicMode=true;
        } else {
          blockLinesLeft = errorBlocks[currentBlock];
        }
      }
    } else {
      // случайные ошибки
      if(Math.random()<0.05) text = `|~CRITICAL_SYSTEM_FAILURE : CODE_${Math.floor(Math.random()*9999)}~|`;
      else if(Math.random()<0.2) text = `|~ERROR_UNKNOWN : CODE_${Math.floor(Math.random()*999)}~|`;
      else text = `|~SYSTEM_LOG_ENTRY_${i} : ACTIVE~|`;
    }

    // делим текст на span для мигания
    lineEl.innerHTML = text.split('').map(c=>`<span class="char">${c}</span>`).join('');

    // позиция и добавление в панике
    if(panicMode){
      lineEl.style.position="absolute";
      lineEl.style.left=Math.random()*(window.innerWidth-200)+'px';
      lineEl.style.top=Math.random()*(window.innerHeight-20)+'px';
      flyingLines.push({el:lineEl, speedX:(Math.random()-0.5)*2, speedY:(Math.random()-0.5)*2});
      updatePanic();
    }

    logDiv.appendChild(lineEl);
    setTimeout(()=>{lineEl.style.opacity=1;},5);

    // автоскролл до паники
    if(!panicMode) logDiv.scrollTop = logDiv.scrollHeight;

    i++;

    // хаотичная скорость печатки после паники
    let delay;
    if(!panicMode){
      delay = 50 + Math.random()*50; // до паники
    } else {
      delay = 5 + Math.random()*100; // хаотично после паники
    }

    setTimeout(showLine, delay);
  }

  showLine();
});
</script>
</body>
</html>