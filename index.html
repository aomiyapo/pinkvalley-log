<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pink Valley Panic Log</title>
<style>
body {
  margin:0;
  padding:0;
  font-family: monospace;
  background:black;
  color:#ff69b4;
  overflow:hidden;
}
#log {
  height:100vh;
  overflow-y:auto;
  position:relative;
}
.line {
  opacity:0;
  transition:opacity 0.1s;
  display:block;
  margin-bottom:2px;
  white-space: pre;
}
.error {
  color:#ff1493;
  font-weight:bold;
}
.failure {
  animation: glitch 3s infinite;
}
@keyframes glitch {
  0%{background-color:black;}
  50%{background-color:#2b001f;}
  100%{background-color:black;}
}
.char {
  display:inline-block;
  transition: color 0.2s;
}
</style>
</head>
<body>
<div id="log"></div>
<script>
document.addEventListener('DOMContentLoaded', ()=>{
  const logDiv = document.getElementById('log');

  const lines = [
"|~USER_ID           : 01~|",
"|~PROFILE_STATE     : RUNNING..~|",
"|~RESPIRATION       : [ON]~|",
"|~OXYGEN_LEVEL      : 98%~|",
"|~HEART_RATE        : 72 BPM~|",
"|~LOCATION          : UNKNOWN~|",
"|~LOCATION_UPDATE   : SUPERMARKET~|",
"|~LIGHTING_STATUS   : FLICKERING~|",
"|~AUDIO_INPUT       : DISTANT HUM~|",
"|~ENTITY_SCAN       : NEGATIVE~|",
"|~AISLE_03_STATUS   : EMPTY~|",
"|~AISLE_07_STATUS   : PRODUCT_DISPLACED~|",
"|~FREEZER_TEMP      : -12C~|",
"|~OXYGEN_LEVEL      : 95%~|",
"|~NOISE_SOURCE      : UNKNOWN~|",
"|~ENTITY_SCAN       : POSITIVE~|",
"|~ENTITY_DISTANCE   : 24m~|",
"|~ENTITY_DISTANCE   : 18m~|",
"|~ENTITY_DISTANCE   : 11m~|",
"|~HEART_RATE        : 103 BPM~|",
"|~ESCAPE_ROUTE      : BLOCKED~|",
"|~DOOR_ACCESS       : DENIED~|",
"|~AUDIO_FEEDBACK    : STATIC~|",
"|~LOCATION_UPDATE   : TILE_CORRIDOR~|",
"|~CORRIDOR_LENGTH   : EXTENDED~|",
"|~LIGHTING_STATUS   : DIM~|",
"|~WALL_PATTERN      : REPEATING~|",
"|~ENTITY_SCAN       : LOST_SIGNAL~|",
"|~FOOTSTEP_AUDIO    : ECHO~|",
"|~HEART_RATE        : 119 BPM~|",
"|~SYSTEM_GLITCH     : TRUE~|",
"|~TEXTURE_ERROR     : CODE_441~|",
"|~CORRIDOR_END      : NOT_FOUND~|",
"|~CORRIDOR_END      : NOT_FOUND~|",
"|~LOCATION_UPDATE   : SCHOOL_BUILDING~|",
"|~ROOM_ID           : CLASSROOM_04~|",
"|~BOARD_TEXT        : UNREADABLE~|",
"|~DESK_COUNT        : 19~|",
"|~STUDENT_STATUS    : NONE_PRESENT~|",
"|~ENTITY_SCAN       : POSITIVE~|",
"|~ENTITY_ID         : TILIN~|",
"|~ENTITY_BEHAVIOR   : STATIONARY~|",
"|~ENTITY_HEAD_ROT   : 180_DEG~|",
"|~AUDIO_INPUT       : BREATHING~|",
"|~HEART_RATE        : 137 BPM~|",
"|~ESCAPE_ROUTE      : DOOR_OPEN~|",
"|~LOCATION_UPDATE   : SHOWER_ROOM~|",
"|~WATER_FLOW        : ACTIVE~|",
"|~TEMPERATURE       : 41C~|",
"|~FLOOR_STATUS      : WET~|",
"|~REFLECTION_STATUS : DISTORTED~|",
"|~ENTITY_REFLECTION : PRESENT~|"
];

  for(let j=1;j<=10000;j++){
    lines.push(`|~SYSTEM_LOG_ENTRY_${j} : ACTIVE~|`);
  }

  let i = 0;
  let failurePhase = false;
  const errorBlocks = [5,7,4,6];
  let currentBlock = 0;
  let blockLinesLeft = 0;
  let inBlock = false;
  let panicMode = false;

  const flyingLines = [];

  function updatePanic() {
    flyingLines.forEach(l=>{
      l.style.left = Math.random()*(window.innerWidth-100)+"px";
      l.style.top = Math.random()*(window.innerHeight-20)+"px";
      l.style.transform = `rotate(${Math.random()*360-180}deg)`;
      // мигание букв
      const chars = l.querySelectorAll('.char');
      chars.forEach(c=>{
        if(Math.random()<0.1){
          c.style.color = ['#ff69b4','#ff1493','#ffb6c1'][Math.floor(Math.random()*3)];
        }
      });
    });
    requestAnimationFrame(updatePanic);
  }

  function showLine(){
    if(i>=lines.length) return;

    const lineEl = document.createElement('div');
    lineEl.className = 'line';
    let isError=false;

    if(i>=700 && !failurePhase){
      failurePhase = true;
      document.body.classList.add('failure');
      inBlock = true;
      blockLinesLeft = errorBlocks[0];
      currentBlock = 0;
    }

    if(failurePhase && inBlock && currentBlock<errorBlocks.length){
      lineEl.textContent = `|~CRITICAL_SYSTEM_FAILURE : CODE_${Math.floor(Math.random()*9999)}~|`;
      lineEl.classList.add('error');
      lineEl.style.position="relative";
      lineEl.style.left=`${Math.random()*40-20}px`;
      lineEl.style.top=`${Math.random()*20-10}px`;
      lineEl.style.transform=`rotate(${Math.random()*8-4}deg)`;
      blockLinesLeft--;
      isError = true;

      if(blockLinesLeft<=0){
        inBlock=false;
        currentBlock++;
        if(currentBlock>=errorBlocks.length){
          panicMode=true;
          const allLines = document.querySelectorAll('.line');
          allLines.forEach(l=>{
            l.style.position="absolute";
            l.style.left=Math.random()*(window.innerWidth-100)+"px";
            l.style.top=Math.random()*(window.innerHeight-20)+"px";
            l.style.transform = `rotate(${Math.random()*360-180}deg)`;
            // разбиваем текст на span для мигания
            l.innerHTML = l.textContent.split('').map(c=>`<span class="char">${c}</span>`).join('');
            flyingLines.push(l);
          });
          updatePanic();
        }
      }
    }

    if(Math.random()<0.2){
      lineEl.textContent = `|~ERROR_UNKNOWN : CODE_${Math.floor(Math.random()*999)}~|`;
      lineEl.classList.add('error');
      isError = true;
    }

    if(!isError) lineEl.textContent = lines[i];

    logDiv.appendChild(lineEl);

    if(panicMode){
      lineEl.style.position="absolute";
      lineEl.style.left=Math.random()*(window.innerWidth-100)+"px";
      lineEl.style.top=Math.random()*(window.innerHeight-20)+"px";
      lineEl.style.transform = `rotate(${Math.random()*360-180}deg)`;
      lineEl.innerHTML = lineEl.textContent.split('').map(c=>`<span class="char">${c}</span>`).join('');
      flyingLines.push(lineEl);
    } else {
      logDiv.scrollTop = logDiv.scrollHeight;
    }

    setTimeout(()=>{lineEl.style.opacity=1},5);

    i++;

    let delay = 200;
    if(failurePhase){
      if(inBlock && currentBlock<=errorBlocks.length){
        delay = 150 + Math.random()*50;
      } else if(panicMode){
        delay = 5 + Math.random()*15;
      } else {
        delay = 20 + Math.random()*40;
      }
    } else if(i>50){
      delay = 20 + Math.random()*40;
    }

    setTimeout(showLine, delay);
  }

  showLine();
});
</script>
</body>
</html>